#!/bin/bash
PORT=${PORT:-8080}
ECHO=${ECHO:-echo}
LENGTH=$(echo "$ECHO" | wc -c)

RESPONSE="HTTP/1.1 200 OK\r\nContent-Length: $LENGTH\r\nConnection: close\r\n\r\n$ECHO"

echo "Listening on $PORT"
while true; do
  { echo -en "$RESPONSE" | nc -l "$PORT" &>/dev/null; } || break
done
echo "Quiting..."
